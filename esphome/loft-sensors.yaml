##############################################################
# Richard Huish 2025
# ESPHome Configuration - Loft Sensors
# Repository: https://github.com/genestealer/Home-Assistant-Configuration
#
# Description:
# This ESPHome configuration monitors the temperature and humidity
# in the loft using a DHT22 sensor. It sends real-time data to 
# Home Assistant via Wi-Fi.
#
# Features:
# - Monitors temperature and humidity using a DHT22 sensor.
# - Sends real-time data to Home Assistant.
#
# Hardware:
# - ESP8266 (NodeMCU v2)
# - DHT22 Sensor (Temperature & Humidity)
#
# Wiring:
# - DHT22 Sensor:
#   - Data (OUT) → GPIO4 (D4)
#   - VCC (3.3V/5V) → 3.3V
#   - GND → GND
# - Status LED:
#   - GPIO16 (D0) → LED Indicator
##############################################################

# Substitutions for Easy Configuration
substitutions:
  # Naming & Identification
  name: loft-sensor
  friendly_name: "Loft Sensors"
  ui_comment: "Loft Sensors"

  # Network Configuration (Static IP)
  ip: 192.168.2.20
  gateway: 192.168.2.1
  subnet: 255.255.255.0

  # Status LED Configuration
  status_led: D0  # GPIO16 - NodeMCU onboard LED
  status_led_inverted: "true"

  # Debug Logging Level
  log_level: DEBUG

  # Sensor Update Interval
  sensor_update_interval: 5min
  wifi_sensor_update_interval: 10min

##############################################################
# Board Configuration
##############################################################
esp8266:
  board: nodemcuv2

##############################################################
# Import Shared Code (Common Components)
##############################################################
packages:
  device_base: !include common/device_base.yaml
  status_led: !include common/status_led.yaml
  wifi: !include common/device_base_wifi.yaml
  # Uncomment below to remove the status LED:
  # status_led: !remove

##############################################################
# Loft Sensor Configuration (DHT22)
##############################################################
sensor:
  # ----------------------
  # Temperature & Humidity Sensor
  # ----------------------
  - platform: dht
    pin: D4  # GPIO4
    temperature:
      name: "Temperature"
      state_class: measurement
      device_class: temperature
      unit_of_measurement: "°C"
      accuracy_decimals: 1
    humidity:
      name: "Humidity"
      state_class: measurement
      device_class: humidity
      unit_of_measurement: "%"
      accuracy_decimals: 1
    update_interval: ${sensor_update_interval}
    model: DHT22
